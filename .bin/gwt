#!/bin/bash

set -euo pipefail

if [[ $# -ne 1 ]]; then
  echo "Usage: gwt <new_branch_name>" >&2
  exit 1
fi

branch_name="$1"

# gitリポジトリのルートからリポジトリ名を取得
repo_root="$(git rev-parse --show-toplevel 2>/dev/null)" || {
  echo "Error: gitリポジトリ内で実行してください" >&2
  exit 1
}
repo_name="$(basename "$repo_root")"

dir_name="${branch_name//\//-}"
worktree_path="../${repo_name}-${dir_name}"

git worktree add "$worktree_path" -b "$branch_name"
